<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Task Prioritizer - AI-powered task analysis and prioritization">
  <title>Task Prioritizer</title>
  
  <style>
    /* Global Styles */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 2rem;
    }

    /* Main Container */
    main {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }

    h1 {
      font-size: 2.5rem;
      color: #667eea;
      margin-bottom: 1rem;
      text-align: center;
    }

    /* Form Styles */
    #task-form {
      margin-bottom: 2rem;
    }

    label {
      display: block;
      font-weight: 600;
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      color: #555;
    }

    /* Textarea Styles - T015, T016, T017 */
    #task-input {
      width: 100%;
      padding: 1rem;
      font-size: 1rem;
      font-family: inherit;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      resize: vertical;
      transition: border-color 0.3s ease;
      min-height: 150px;
      white-space: pre-wrap; /* T017: Preserve user input formatting */
    }

    #task-input:focus {
      outline: none;
      border-color: #667eea;
    }

    #task-input::placeholder {
      color: #999;
    }

    /* Responsive textarea sizing - T016 */
    @media (max-width: 768px) {
      #task-input {
        font-size: 16px; /* Prevents zoom on mobile */
        padding: 0.75rem;
      }
    }

    /* Button Styles - T020 */
    button[type="submit"] {
      width: 100%;
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      color: white;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      margin-top: 1rem;
    }

    button[type="submit"]:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    button[type="submit"]:active {
      transform: translateY(0);
    }

    button[type="submit"]:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    /* Error Message Styles - T021 */
    .error {
      color: #e53e3e;
      background-color: #fff5f5;
      border: 1px solid #fc8181;
      border-radius: 6px;
      padding: 0.75rem;
      margin-top: 1rem;
      font-size: 0.95rem;
    }

    .hidden {
      display: none;
    }

    /* Results Container - T030: CSS Grid Layout */
    #results-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 2rem;
      animation: fadeIn 0.4s ease-in;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* T032: Responsive - Stack on mobile */
    @media (max-width: 768px) {
      #results-container {
        grid-template-columns: 1fr;
      }
      
      main {
        padding: 1.5rem;
      }
      
      h1 {
        font-size: 2rem;
      }
    }

    /* Panel Styles - T031 */
    .panel {
      background: #f8f9fa;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      padding: 1.5rem;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .panel h2 {
      font-size: 1.4rem;
      color: #667eea;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #667eea;
    }

    /* Original Task Display - T039: Preserve whitespace */
    .task-content {
      background: white;
      padding: 1rem;
      border-radius: 6px;
      border: 1px solid #e0e0e0;
      white-space: pre-wrap;
      word-wrap: break-word;
      font-size: 1rem;
      line-height: 1.6;
      color: #333;
    }

    /* Analysis Display Styles - T038 */
    .analysis-field {
      margin-bottom: 1.5rem;
    }

    .analysis-field:last-child {
      margin-bottom: 0;
    }

    .field-label {
      font-weight: 600;
      font-size: 0.95rem;
      color: #666;
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .field-value {
      font-size: 1rem;
      color: #333;
    }

    /* Priority Badges */
    .priority-badge {
      display: inline-block;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 600;
      font-size: 1rem;
    }

    .priority-HIGH {
      background-color: #fee;
      color: #c53030;
      border: 2px solid #fc8181;
    }

    .priority-MEDIUM {
      background-color: #fef5e7;
      color: #d97706;
      border: 2px solid #fbbf24;
    }

    .priority-LOW {
      background-color: #f0fdf4;
      color: #059669;
      border: 2px solid #6ee7b7;
    }

    /* Complexity Indicators */
    .complexity-badge {
      display: inline-block;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      font-weight: 600;
      font-size: 1rem;
    }

    .complexity-HIGH {
      background-color: #fce4ec;
      color: #ad1457;
    }

    .complexity-MEDIUM {
      background-color: #fff3e0;
      color: #e65100;
    }

    .complexity-LOW {
      background-color: #e8f5e9;
      color: #2e7d32;
    }

    /* Category Tags */
    .categories-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 0.5rem;
    }

    .category-tag {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 500;
    }

    /* Suggested Order */
    .suggested-order {
      background: white;
      padding: 1rem;
      border-left: 4px solid #667eea;
      border-radius: 4px;
      font-style: italic;
      color: #555;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <!-- T010: Main container with semantic HTML -->
  <main>
    <!-- T011: Page heading -->
    <h1>Task Prioritizer</h1>
    
    <!-- T012: Form container -->
    <form id="task-form" aria-label="Task analysis form">
      <!-- T013: Label for textarea -->
      <label for="task-input">Enter Task Description</label>
      
      <!-- T014: Textarea input with maxlength and rows -->
      <!-- T048: Enhanced accessibility attributes -->
      <textarea 
        id="task-input" 
        name="task-input"
        maxlength="10000" 
        rows="8"
        placeholder="e.g., Fix the bug in the login form"
        aria-label="Task description input"
        aria-describedby="error-message"
        aria-required="true"
      ></textarea>
      
      <!-- T018: Submit button -->
      <button type="submit" aria-label="Analyze task and show results">Analyze Task</button>
      
      <!-- T019: Error message container -->
      <div id="error-message" class="error hidden" role="alert" aria-live="polite" aria-atomic="true"></div>
    </form>
    
    <!-- T027: Results container (hidden initially) -->
    <div id="results-container" class="hidden">
      <!-- T028: Left panel - Original Task -->
      <div class="panel">
        <h2>Original Task</h2>
        <div id="original-task" class="task-content"></div>
      </div>
      
      <!-- T029: Right panel - AI Analysis -->
      <div class="panel">
        <h2>AI Analysis</h2>
        <div id="analysis-result"></div>
      </div>
    </div>
  </main>
  
  <script>
    // ==============================================
    // TASK PRIORITIZER - WORKSHOP DEMO
    // ==============================================
    // This application demonstrates:
    // - Vanilla JavaScript (no frameworks)
    // - CSS Grid for responsive layout
    // - Form validation
    // - Mock data simulation
    // ==============================================

    // T054: Workshop comments for clarity

    // Mock Data - Based on contracts/mock-data.json
    // This object simulates AI analysis responses
    // In a real app, this would be an API call
    const mockAnalyses = {
      "Fix the bug in the login form": {
        priority: "HIGH",
        categories: ["CRITICAL-PATH", "USER-FACING", "SECURITY"],
        complexity: "MEDIUM",
        suggestedOrder: "Do this before feature work - blocks user access"
      },
      "Write unit tests for payment module": {
        priority: "HIGH",
        categories: ["TESTING", "CRITICAL-PATH"],
        complexity: "HIGH",
        suggestedOrder: "Essential before next release - prevents regressions in critical path"
      },
      "Update README documentation": {
        priority: "LOW",
        categories: ["DOCUMENTATION"],
        complexity: "LOW",
        suggestedOrder: "Schedule during quiet periods or between sprints"
      },
      "Refactor legacy API endpoints": {
        priority: "MEDIUM",
        categories: ["TECHNICAL-DEBT", "INFRASTRUCTURE"],
        complexity: "HIGH",
        suggestedOrder: "Plan for dedicated refactoring sprint - high effort but not blocking"
      },
      "Add dark mode toggle": {
        priority: "MEDIUM",
        categories: ["FEATURE", "USER-FACING"],
        complexity: "MEDIUM",
        suggestedOrder: "Nice-to-have enhancement - schedule after critical bugs are resolved"
      },
      "Investigate performance bottleneck in search": {
        priority: "HIGH",
        categories: ["BUG-FIX", "USER-FACING"],
        complexity: "MEDIUM",
        suggestedOrder: "Impacts user experience significantly - prioritize investigation and fix"
      }
    };

    // Default analysis for unmatched tasks
    const defaultAnalysis = {
      priority: "MEDIUM",
      categories: ["GENERAL"],
      complexity: "MEDIUM",
      suggestedOrder: "Review and prioritize based on current sprint goals"
    };

    // T022: Validation function per data-model.md
    function validateTaskInput(text) {
      const trimmed = text.trim();
      
      if (trimmed.length === 0) {
        return {
          valid: false,
          error: "Please enter a task description"
        };
      }
      
      if (trimmed.length > 10000) {
        return {
          valid: false,
          error: "Task description too long (max 10,000 characters)"
        };
      }
      
      return { valid: true };
    }

    // Get DOM elements
    const form = document.getElementById('task-form');
    const textarea = document.getElementById('task-input');
    const errorMessage = document.getElementById('error-message');
    const resultsContainer = document.getElementById('results-container');
    const originalTaskDiv = document.getElementById('original-task');
    const analysisResultDiv = document.getElementById('analysis-result');
    
    // T043: Debounce flag for rapid submissions
    let isSubmitting = false;

    // T034: Analyze task using mock data lookup
    function analyzeTask(taskDescription) {
      const normalizedText = taskDescription.trim();
      
      // Exact match lookup in mock data
      if (mockAnalyses[normalizedText]) {
        return mockAnalyses[normalizedText];
      }
      
      // Return default analysis for unmatched tasks
      return defaultAnalysis;
    }

    // T036: Display analysis with formatted HTML
    function displayAnalysis(analysis) {
      let html = '';
      
      // Priority
      html += `
        <div class="analysis-field">
          <div class="field-label">Priority</div>
          <div class="field-value">
            <span class="priority-badge priority-${analysis.priority}">${analysis.priority}</span>
          </div>
        </div>
      `;
      
      // Categories
      html += `
        <div class="analysis-field">
          <div class="field-label">Categories</div>
          <div class="categories-list">
            ${analysis.categories.map(cat => `<span class="category-tag">${cat}</span>`).join('')}
          </div>
        </div>
      `;
      
      // Complexity
      html += `
        <div class="analysis-field">
          <div class="field-label">Estimated Complexity</div>
          <div class="field-value">
            <span class="complexity-badge complexity-${analysis.complexity}">${analysis.complexity}</span>
          </div>
        </div>
      `;
      
      // Suggested Order
      html += `
        <div class="analysis-field">
          <div class="field-label">Suggested Order</div>
          <div class="suggested-order">${analysis.suggestedOrder}</div>
        </div>
      `;
      
      return html;
    }

    // T035: Display results - populate original task
    function displayResults(taskText, analysis) {
      // T040: Clear previous results before displaying new ones
      originalTaskDiv.textContent = '';
      analysisResultDiv.innerHTML = '';
      
      // Small delay for smooth transition (T042: fade effect)
      setTimeout(() => {
        // Display original task text (preserves formatting)
        originalTaskDiv.textContent = taskText;
        
        // Display formatted analysis
        analysisResultDiv.innerHTML = displayAnalysis(analysis);
      }, 50);
      
      // T037: Show results container
      resultsContainer.classList.remove('hidden');
      
      // Smooth scroll to results
      resultsContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
    }

    // T023: Form submit event handler (T041: supports repeated submissions)
    function handleSubmit(event) {
      event.preventDefault();
      
      // T043: Prevent rapid duplicate submissions
      if (isSubmitting) {
        return;
      }
      
      const taskText = textarea.value;
      
      // T024: Show error for empty textarea
      const validation = validateTaskInput(taskText);
      if (!validation.valid) {
        errorMessage.textContent = validation.error;
        errorMessage.classList.remove('hidden');
        return;
      }
      
      // T025: Clear error on valid input
      errorMessage.classList.add('hidden');
      errorMessage.textContent = '';
      
      // T043: Set submitting flag
      isSubmitting = true;
      
      // Get analysis and display results
      const analysis = analyzeTask(taskText);
      displayResults(taskText, analysis);
      
      // T044: Don't clear textarea (allow easy editing for next submission)
      // Textarea remains with current text for user convenience
      
      // T043: Reset submitting flag after short delay
      setTimeout(() => {
        isSubmitting = false;
      }, 300);
    }

    // T026: Event handlers to clear error message
    textarea.addEventListener('input', () => {
      if (!errorMessage.classList.contains('hidden')) {
        errorMessage.classList.add('hidden');
        errorMessage.textContent = '';
      }
    });

    textarea.addEventListener('focus', () => {
      if (!errorMessage.classList.contains('hidden')) {
        errorMessage.classList.add('hidden');
        errorMessage.textContent = '';
      }
    });

    // Attach form submit handler
    form.addEventListener('submit', handleSubmit);
  </script>
</body>
</html>

